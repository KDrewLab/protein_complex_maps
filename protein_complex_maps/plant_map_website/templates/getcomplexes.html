{% include 'header.html' %}

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">plant.MAP</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="/">Home</a></li>
            <li><a href="/about">About</a></li>
            <li><a href="/download">Download</a></li>

          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container theme-showcase" role="main">

{% include 'jumbotron.html' %}
{% include 'introheader.html' %}
{% include 'protsearchform.html' %}

    <p>

    {% if error %}
        <h3>{{error}}</h3>
    {% endif %}

    {% set clustid_labels = ['Most restrictive complex membership',
                             'Second most restrictive complex membership',
                             'Third most restrictive complex membership',
                             'Most inclusive complex membership'] %}
    {% set counter = 0 %}
    <ul>


    <!-- https://www.uniprot.org/uniprot/?query=I1KDU3+OR+I1M368+OR+I1M369+OR+I1M370+OR+K7KX13&sort=score -->
    <h4><i> Complexes ordered from most restrictive to most inclusive. Start with first listed complex for highest confidence complex membership. The last will be most inclusive, but in some cases will include multiple complexes. </i></h4>
    <hr>
    {% for comp in complexes | reverse %}
        <strong><h3>{{ clustid_labels[loop.index -1]}}</h3></strong>
        

        <table class="table table-striped">
            <thead>
            <tr>
                <th>OrthogroupID

                      <button class="btn btn-default btn-xs" onclick="orthogroupFunction()">?</button>
                      <script>
                        function orthogroupFunction() {
                        alert("eggNOG4.0 virNOG (viridiplantae) orthogroup identifier http://eggnogdb.embl.de");
                        }
                      </script></th>
                <th>Orthogroup Annotation
                      <button class="btn btn-default btn-xs" onclick="orthoannotFunction()">?</button>
                      <script>
                        function orthoannotFunction() {
                        alert("Autogenerated by eggNOG http://eggnogdb.embl.de");
                        }
                      </script></th>
                <th>Arabidopsis Gene Name(s)</th>
                <th>Species
                      <button class="btn btn-default btn-xs" onclick="specFunction()">?</button>
                      <script>
                        function specFunction() {
                        alert("Species codes:\narath : Arabidopsis\nbraol : Broccoli\nchlre : Chlamydomonas\ncocnu : Coconut\ncansa : Hemp\nsollc : Tomato\nmaize : Maize\nchqui : Quinoa\norysj : Rice\nsoybn : Soy\nselml : Spikemoss\nwheat : Wheat\ncerri : C-Fern");
                        }
                      </script></th>
                <th>Protein ID(s)
                      <button class="btn btn-default btn-xs" onclick="protFunction()">?</button>
                      <script>
                        function protFunction() {
                        alert("Proteins in selected species contained in ortholog group (i.e. duplications since last common plant ancestor");
                        }
                      </script></th>
                <th>TAIR Link(s)</th>
                <th>Uniprot Link
                 <button class="btn btn-default btn-xs" onclick="uniprotFunction()">?</button>
                      <script>
                        function protFunction() {
                        alert("Uniprot link for all proteins in selected species in selected orthogroup. Not available for Ceratopteris (C-fern), coconut, hemp, and quinoa");
                        }
                      </script></th>
                 </th>
            </tr>
        </thead>
        <tbody>
            {% for og in comp.orthogroups %}

                {% if og.OrthogroupID == current_OrthogroupID %}
                <tr style="font-weight:bold">
                {% else %}
                <tr>
                {% endif %}
                    <td><a href = http://eggnogdb.embl.de/#/app/results?target_nogs={{ og.OrthogroupID }}>{{ og.OrthogroupID }}</a></td>
                    
                       
                    <td>{% for x in og.Orthoannots %}
                             {{ x.EggnogAnnot }}
                        {% endfor %} </td>

                    <td>{% for x in og.Orthoannots %}
                             {{ x.ArathGenenames }}
                        {% endfor %} </td>

                        {% set entrylist = [] %}
                        {% set entrynamelist = [] %}
                        {% set tairlist = [] %}


                        {% set protlist = [] %}
                        {% for x in og.Proteins %}

                           {% if x.Spec == Species %}
                              {% if x.IDtype == "Entry" %}
                                 {% do entrylist.append(x.ProteinID) %}
                              {% endif %}
                              {% if x.IDtype == "EntryName" %}
                                {% do entrynamelist.append(x.ProteinID) %}
                              {% endif %}
                        {% endif %} 
                        {% if x.IDtype == "atnum" %}
                              {% do tairlist.append(x.ProteinID) %}
                           {% endif %}


                        {% endfor %} 

                    <td>{{ Species }}</td>
		    <td>{{ entrylist | join(' ') }}</td>

                    <td>{% for locus in tairlist %}
                           <a href = https://www.arabidopsis.org/servlets/TairObject?type=locus&name={{ locus }}>{{ locus }}</a>
                       {% endfor %}</td>

                          
                        
                    <td><a href = https://www.uniprot.org/uniprot/?query=id:{{entrylist | join("+OR+id:") }}>Uniprot</a> </td>



              {% endfor %}

            </tbody>
        </table>

               <a href="#Images{{comp.clustid_set}}" class="btn btn-default" data-toggle="collapse">Images</a>

              <div id="Images{{comp.clustid_set}}" class="collapse">
                      <button class="btn btn-default btn-xs" onclick="imageFunction()">?</button>
                      <script>
                        function imageFunction() {
                        alert("Elution sparklines for complex. Raw data can be downloaded from the Downloads page: panplant_wide_elution_expnorm.csv. Meta data on each experiment can be found in Experiment_Order.csv.");
                        }
                      </script>                                                    
                  Click image to enlarge or download
                     <a href="static/complex_images/{{comp.clustid_set}}_{{comp.clustid}}.svg" target="_blank">
                     <img src="static/complex_images/{{comp.clustid_set}}_{{comp.clustid}}.svg" alt="Elution sparklines", width=100% height=100%>
                     </a>
              </div>

        <hr>

                             </tr>
            {% else %}
                <em> No proteins</em>





            {% endfor %}
       <br>
    <!--
        <em>No complexes</em>


      -->

    </ul>





{% include 'footer.html' %}






