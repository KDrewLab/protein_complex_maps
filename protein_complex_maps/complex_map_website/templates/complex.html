<!bootstrap-3.3.6/docs/DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../bootstrap-3.3.6/docs/favicon.ico">

    <title>hu.MAP 3.0: Complex View</title>

    <link href="../static/styles/test.css" rel="stylesheet">

    <!-- Bootstrap core CSS -->
    <link href="../static/styles//bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="../static/styles//bootstrap-theme.min.css" rel="stylesheet">
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="../static/styles/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../static/styles/theme.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="../static/js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

  </head>

  <body role="document">

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/h3">hu.MAP 3.0</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/h3">Home</a></li>
            <li><a href="/about">About</a></li>
            <li><a href="/download">Download</a></li>
            <!--
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dropdown <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="#">Action</a></li>
                <li><a href="#">Another action</a></li>
                <li><a href="#">Something else here</a></li>
                <li role="separator" class="divider"></li>
                <li class="dropdown-header">Nav header</li>
                <li><a href="#">Separated link</a></li>
                <li><a href="#">One more separated link</a></li>
              </ul>
            </li>
            -->
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container theme-showcase" role="main">

      <!-- Main jumbotron for a primary marketing message or call to action -->
      <div class="theme">
        <h1>hu.MAP 3.0: Complex View</h1>
        <p> 
            Human Protein Complex Map
        </p>
      </div>

      <div class="page-header">
        <h3>Search for a protein</h3>
      </div>
    <form method="POST" action="/search">
        {{ form.hidden_tag() }}
        {{ form.listOfGenenames.label }} {{ form.listOfGenenames(size=50) }}
        <br>
        <br>
        {{ form.enrichment.label }} {{ form.enrichment(size=50) }}
        <br/>
        <br/>
        {{ form.protein.label }} {{ form.protein(size=50) }}
        <br/>
        <br/>
        {{ form.submit }}
    </form>
 

    {% if error %}
        <h3>{{error}}</h3>
    {% endif %}

    {% if comp != None %}
        <ul>
        <h3>Complex: {{ comp.complex_link()|safe }}</h3>

	{% if comp.complexportal_link() != None %}
		<h4>Complex Portal: {{ comp.complexportal_link()|safe }}</h4>
	{% endif %}

        <h4>Confidence: 
            {% if comp.top_rank == 1 %}
                <a href="#" class="label label-success" data-toggle="tooltip" title="Extremely High">Extremely High</a> &nbsp 
            {% elif comp.top_rank == 2 %}
                <a href="#" class="label label-primary" data-toggle="tooltip" title="Very High">Very High</a> &nbsp 
            {% elif comp.top_rank == 3 %}
                <a href="#" class="label label-info" data-toggle="tooltip" title="High">High</a> &nbsp 
            {% elif comp.top_rank == 4 %}
                <a href="#" class="label label-danger" data-toggle="tooltip" title="Moderate High" background-color=#9f5fa7;>Moderate High</a> &nbsp 
            {% elif comp.top_rank == 5 %}
                <a href="#" class="label label-warning" data-toggle="tooltip" title="Medium High">Medium High</a> &nbsp 
            {% elif comp.top_rank == 6 %}
                <a href="#" class="label label-default" data-toggle="tooltip" title="Medium">Medium</a> &nbsp 
            {% endif %}
            <button class="btn btn-default btn-xs" onclick="complexConfidence()">?</button>
            <script>
                function complexConfidence() {
                                        alert("Complex Confidence\n\nComplexes are classified into confidence groups during clustering. Each group's performance is estimated by calculating precision (100*TP/(TP+FP)) from a training set as well as a leaveout set of literature curated protein interactions.\n\n");
                                }
            </script>  

        </h4>

        <a href="#Proteins" class="btn btn-default" data-toggle="collapse">Proteins</a>
        <div id="Proteins" class="collapse in">
            <table id="proteins" class="table table-striped">
                <thead>
                <tr>
                    <th>Genename</th>
                    <!--
                    <th>Complexes</th>
                    -->
                    <th>Protein Name</th>
                    <th>Uniprot Annotation Score</th>
                    <th>Links</th>
                </tr>
                </thead>
                <tbody>
                {% for prot in comp.sorted_proteins() %}
                    <tr>
                        <td>{{ prot.genename() }}</td>
                        <!--
                        <td>
                            {% for comp in prot.complexes %}
                                {{ comp.complex_link()|safe }}
                            {% else %}
                            {% endfor %}
                        </td>
                        -->
                        <td> {{prot.proteinname}}</td>
                        <td> {{prot.annotation_score}}</td>
                        <td>{{ prot.uniprot_link()|safe }} &nbsp {{ prot.ncbi_link()|safe }}</td>
                    </tr>
                {% else %}
                    <em> No proteins</em>
                {% endfor %}
                </tbody>
            </table>
        </div>

        <br>
        <br>
        <a href="#Enrichments" class="btn btn-default" data-toggle="collapse">Enrichments</a>
        <div id="Enrichments" class="collapse">
            <table id="enrichments" class="table table-striped">
                <thead>
                <tr>
                    <th>Term ID</th>
                    <th>Corrected Pval</th>
                    <th>Fraction Complex Coverage</th>
                    <th>Proteins</th>
                    <th>Term Name</th>
                </tr>
                </thead>
                <tbody>
                {% for enrichment in comp.sorted_enrichments() %}
                    <tr>
                        <td>&nbsp {{ enrichment.native|safe }}</td>
                        <td> {{ enrichment.p_value|safe }}</td>
                        <td> {{ enrichment.precision |safe }}</td>
                        <td>
                            {% for protein in enrichment.get_proteins() %}
                                {{ protein.genename() }}
                            {% else %}
                                <em> No proteins</em>
                            {% endfor %}
                        </td>
                        <td> {{ enrichment.name|safe }}</td>
                    </tr>
                {% else %}
                    &nbsp    <em> No enrichments</em>
                {% endfor %}
                </tbody>
            </table>
        </div>

        <br>
        <br>
        <a href="#Edges" class="btn btn-default" data-toggle="collapse">Edges</a>
        <div id="Edges" class="collapse">
		{% block content %}
		{% set edges = comp.all_edges() %}
            <table id="edges" class="table table-striped">
                <thead>
                <tr>
                    <th>Protein 1 </th>
                    <th>Protein 2 </th>
                    <th>Score <button class="btn btn-default btn-xs" onclick="scoreFunction()">?</button> 
                        <script>
                            function scoreFunction() {
                                alert("Edge Score is a confidence value of the pair of proteins interacting based on the evidence. The value ranges from 0.0 to 1.0 and is calculated by the SVM classifier during the prediction process.");
                            }
                        </script> 
                    
                    </th>                                                   
                    <th>ProteomeHD<button class="btn btn-default btn-xs" onclick="protHDFunction()">?</button>
                        <script>
                            function protHDFunction() {
                                alert("ProteomeHD scores represent the probability of protein coexpression from a RandomForest training model.");
                            }
                        </script>                                                    
                    </th>
                    <th>Interface Overlap<button class="btn btn-default btn-xs" onclick="interfaceFunction()">?</button>
                        <script>
                            function interfaceFunction() {
				    alert("Interface Overlap represent whether the pair of proteins are mutually exclusive or structurally consisent based on AlphaFold modeling. There are four categories of interface overlap: \n\n mutually_exclusive: two proteins are predicted to bind at the same interface of a third protein listed in parentheses.\nstructurally_consistent: two proteins are predicted to bind at different interfaces of the a thrid protein listed in parentheses.\nstructurally_consistent (dimer): two proteins have a confident AlphaFold model as a dimer\nmixed_interface: AlphaFold models for the three proteins are inconsistent. Caution and manually inspection should be used.\n\nNote: Interface Overlap can be context specific. This means pair of proteins can be structurally consistent in some cellular conditions and mutually exclusive in others. Caution is recommended for these cases.");
                            }
                        </script>                                                    
                    </th>

		    {% set EDGELIMIT = 50 %}
		    {% if edges|length < EDGELIMIT %}

                    <th>Evidence <button class="btn btn-default btn-xs" onclick="evidenceFunction()">?</button>
                    <script>
                        function evidenceFunction() {
                            alert("Edge Evidence Key\n\nNote: Evidence listed does not necessiarily mean positive evidence but rather only means there is data for this particular pair of proteins\n\nfraction = co-elution relationship in Wan et al.\n\nbioplex = bait-prey relationship in Bioplex or Bioplex2, bait(s) in parentheses\n\nhein = bait-prey relationship in Hein et al., bait(s) in parentheses\n\nyoun = bait-prey relationship in proximity labeling experiments from Youn et al., bait(s) in parentheses\n\ngupta = bait-prey relationship in proximity labeling experiments from Gupta et al., bait(s) in parentheses\n\nboldt = bait-prey or prey-prey relationship from Boldt et al., bait(s) in parentheses\n\nMalovannaya = bait-prey relationship from Malovannaya et al.\n\nGuru = bait-prey relationship from Guru et al.\n\nbioplex_WMM = prey-prey relationship in Bioplex based on weighted matrix model (WMM) \n\nhein_WMM = prey-prey relationship in Hein et al. based on weighted matrix model (WMM)\n\ngupta_WMM = prey-prey relationship in Gupta et al. based on weighted matrix model (WMM)\n\nboldt_WMM = prey-prey relationship in Boldt et al. based on weighted matrix model (WMM)\n\nyoun_WMM = prey-prey relationship in Youn et al. based on weighted matrix model (WMM)\n\ntreiber_WMM = prey-prey relationship in Treiber et al. based on weighted matrix model (WMM)\n\nWMM_only = evidence is only from weighted matrix model and is not direct from spoke model interpretation of experiments ");
                        }
                    </script>                                                    
                    </th>
			{% endif %}

                </tr>
                </thead>
                <tbody>
                {% for edge in edges %}
                    <tr>
                        <td>&nbsp{{ edge.get_proteins()[0].genename() }}</td>
                        <td>&nbsp{{ edge.get_proteins()[1].genename() }}</td>
                        <td> {{ edge.score|round(3)|safe }}</td>

			{% set prothd_score = edge.get_prothd_score() %}
                        {% if prothd_score > 0.8 %}
                            <td><span style="color:007c80;">{{ prothd_score|safe }}</span>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</td>
                        {% elif prothd_score> 0.6 %}
                            <td><span style="color:57C4AD;">{{ prothd_score|safe }}</span>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</td>
                        {% elif prothd_score> 0.4 %}
                            <td><span style="color:E1AD01;">{{ prothd_score|safe }}</span>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</td>
                        {% elif prothd_score> 0.2 %}
                            <td><span style="color:E98F20;">{{ prothd_score|safe }}</span>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</td>
                        {% elif prothd_score> 0.0 %}
                            <td> <span style="color:DB4325;">{{ prothd_score|safe }}</span>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</td>
                        {% else %}
                            <td> &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</td>
                        {% endif %}

			<!-- Interface Overlap -->
			<td>
				{% if edge.get_interface_mutex() == None %}
				    &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
				{% else %}
					{% for entry in edge.get_interface_mutex()  %}

						{% if 'mutually_exclusive' in entry %}
							<span style="color:f36d21;">{{ entry|safe }}</span>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
							<br>
						{% elif 'structurally_consistent' in entry %}
							<span style="color:2278b5;">{{ entry|safe }}</span>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
							<br>
						{% elif 'mixed_interface' in entry %}
							<span style="color:858687;">{{ entry|safe }}</span>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
							<br>
						{% else %}
						    &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
						{% endif %}
					{% endfor %}
				{% endif %}
			</td>
			{% if edges|length < EDGELIMIT %}

				<td>
				    {% for evidence in edge.evidences %}
					{{ evidence.evidence_type|safe }} &nbsp &nbsp 
				    {% else %}
					<em> No Evidences</em>
				    {% endfor %}
				</td>

			{% endif %}

                    </tr>
                {% else %}
                    &nbsp    <em> No edges</em>
                {% endfor %}
                </tbody>
            </table>
	    {% endblock %}
        </div>

        <br>
        <br>
	<!--kdrew: distribution of edge precision values-->
	<!--
        <a href="#Images" class="btn btn-default" data-toggle="collapse">Images</a>
        <div id="Images" class="collapse">
        <br>
            <button class="btn btn-default btn-xs" onclick="imageFunction()">?</button>
            <script>
            function imageFunction() {
            alert("The plot shows the distribution of edge precision values for the complex (blue). Precision values are empirically determined using a benchmark of literature curated complexes from the CORUM database. The average of edge precision values for the complex is shown as a red triangle. For comparison, a distribution of edge precision values for random pairs of proteins (orange) is also shown.");
            }
            </script>                                                    
        <br>
        <br>
        Click to enlarge
        <br>
        <a href="/static/images/complex_window_precision_distribution_plots/complex_window_precision_distribution_{{comp.humap_id}}-1.png" target="_blank">
        <img src="/static/images/complex_window_precision_distribution_plots/complex_window_precision_distribution_{{comp.humap_id}}-1.png" alt="ComplexPrecisionDistribution" width=45% height=50%> 
    </a>
        <br>
	{% if comp.average_window_precision > 0 %}
        Complex {{ comp.humap_id }} has an average edge precision of {{ comp.average_window_precision|round(3) }} which is ranked {{ comp.average_window_precision_rank }} out of all 6965 complexes.
	{% endif %}
        </div>
	-->

        <br>
        <br>
        <a href="#RelatedComplexes" class="btn btn-default" data-toggle="collapse">Related Complexes</a>
        <div id="RelatedComplexes" class="collapse">
            <table class="table table-striped">
                <thead>
                <tr>
                    <th>Genename</th>
                    <th>Complexes</th>
                </tr>
                </thead>
                <tbody>
                {% for prot in comp.sorted_proteins() %}
                    <tr>
                        <td>{{ prot.genename() }}</td>
                        <td>
                            {% for comp in prot.complexes %}
                                {{ comp.complex_link()|safe }}
                            {% else %}
                            {% endfor %}
                        </td>
                    </tr>
                {% else %}
                    <em> No proteins</em>
                {% endfor %}
                </tbody>
            </table>
        </div>


        <br>

        </ul>
    {% endif %}
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../static/js/jquery.min.js"><\/script>')</script>
    <script src="../static/js/bootstrap.min.js"></script>
    <script src="../static/js/docs.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../static/js/ie10-viewport-bug-workaround.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.25/js/dataTables.bootstrap.js"></script>
	{% block scripts %}
	<script>
		$(document).ready(function () {
		$('#proteins').DataTable({
			    ordering: true
			} );
		$('#enrichments').DataTable({
			    ordering: true,
				order: [[1, 'asc']],
			} );
		$('#edges').DataTable({
			    ordering: true,
				order: [[2, 'desc']],
			} );
		});
	</script>
	{% endblock %}
  </body>
</html>

